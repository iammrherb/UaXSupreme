! Cisco IOS-XE 802.1X/RADIUS/TACACS+ Configuration
! Generated by Dot1Xer Supreme Enterprise Edition v4.2.0
! Vendor: Cisco
! Platform: IOS-XE
! Version: {{platform-version}}

!=====================================================================
! TACACS+ CONFIGURATION
!=====================================================================
{{#useTacacs}}
! TACACS+ Servers
tacacs server TACACS-SERVER-1
 address ipv4 {{tacacsServer1}}
 key {{tacacsKey1}}
 timeout {{tacacsTimeout}}
 single-connection
{{#tacacsServer2}}
tacacs server TACACS-SERVER-2
 address ipv4 {{tacacsServer2}}
 key {{tacacsKey2}}
 timeout {{tacacsTimeout}}
 single-connection
{{/tacacsServer2}}

! TACACS+ Server Group
aaa group server tacacs+ TACACS-GROUP
 server name TACACS-SERVER-1
{{#tacacsServer2}}
 server name TACACS-SERVER-2
{{/tacacsServer2}}
 ip tacacs source-interface {{tacacsSourceInterface}}

! Device Administration Authentication
aaa authentication login default group TACACS-GROUP local
aaa authentication login CONSOLE local
aaa authentication enable default group TACACS-GROUP enable
aaa authorization console
aaa authorization exec default group TACACS-GROUP local if-authenticated
aaa authorization commands 0 default group TACACS-GROUP local if-authenticated
aaa authorization commands 1 default group TACACS-GROUP local if-authenticated
aaa authorization commands 15 default group TACACS-GROUP local if-authenticated
aaa accounting exec default start-stop group TACACS-GROUP
aaa accounting commands 0 default start-stop group TACACS-GROUP
aaa accounting commands 1 default start-stop group TACACS-GROUP
aaa accounting commands 15 default start-stop group TACACS-GROUP
{{/useTacacs}}

!=====================================================================
! RADIUS CONFIGURATION
!=====================================================================
! Primary RADIUS Server
radius server RAD-SERVER-1
 address ipv4 {{radiusServer1}} auth-port {{radiusAuthPort1}} acct-port {{radiusAcctPort1}}
 key {{radiusKey1}}
 timeout {{radiusTimeout}}
 retransmit {{radiusRetransmit}}
 automate-tester username {{radiusTestUser}} probe-on

{{#radiusServer2}}
! Secondary RADIUS Server
radius server RAD-SERVER-2
 address ipv4 {{radiusServer2}} auth-port {{radiusAuthPort2}} acct-port {{radiusAcctPort2}}
 key {{radiusKey2}}
 timeout {{radiusTimeout}}
 retransmit {{radiusRetransmit}}
 automate-tester username {{radiusTestUser}} probe-on
{{/radiusServer2}}

! RADIUS Server Group
aaa group server radius RAD-SERVERS
 server name RAD-SERVER-1
{{#radiusServer2}}
 server name RAD-SERVER-2
{{/radiusServer2}}
 deadtime {{radiusDeadtime}}
 ip radius source-interface {{radiusSourceInterface}}

!=====================================================================
! RADIUS CoA (CHANGE OF AUTHORIZATION) CONFIGURATION
!=====================================================================
{{#useCoa}}
aaa server radius dynamic-author
 client {{radiusServer1}} server-key {{radiusKey1}}
{{#radiusServer2}}
 client {{radiusServer2}} server-key {{radiusKey2}}
{{/radiusServer2}}
 auth-type any
 port {{coaPort}}
{{/useCoa}}

!=====================================================================
! RADSEC (RADIUS OVER TLS/DTLS) CONFIGURATION
!=====================================================================
{{#useRadsec}}
! RadSec Certificates
crypto pki trustpoint TP-RADSEC
 enrollment terminal
 revocation-check none
 
! RadSec Server Configuration
radius server RADSEC-SERVER
 address ipv4 {{radiusServer1}}
 key radius/dtls
 dtls trustpoint client TP-RADSEC
 dtls trustpoint server TP-RADSEC
 dtls port {{radsecPort}}
{{/useRadsec}}

!=====================================================================
! 802.1X GLOBAL SETTINGS
!=====================================================================
dot1x system-auth-control
aaa authentication dot1x default group RAD-SERVERS
aaa authorization network default group RAD-SERVERS
{{#enableAccounting}}
aaa accounting dot1x default start-stop group RAD-SERVERS
aaa accounting network default start-stop group RAD-SERVERS
aaa accounting update newinfo periodic {{accountingInterval}}
{{/enableAccounting}}

!=====================================================================
! INTERFACE CONFIGURATION
!=====================================================================
{{#interface}}
interface {{interface}}
 switchport mode access
 switchport access vlan {{vlanAuth}}
{{#vlanVoice}}
 switchport voice vlan {{vlanVoice}}
{{/vlanVoice}}
 
 ! 802.1X Interface Configuration
 dot1x pae authenticator
 dot1x timeout tx-period {{txPeriod}}
 dot1x max-reauth-req {{maxReauth}}
 authentication periodic
 authentication timer reauthenticate {{reauthPeriod}}
 authentication port-control {{#authMode eq "open"}}auto{{/authMode}}{{#authMode eq "closed"}}force-authorized{{/authMode}}
 authentication host-mode {{hostMode}}

{{#authMethod eq "mab" or authMethod eq "dot1x-mab" or authMethod eq "concurrent"}}
 ! MAC Authentication Bypass
 mab
{{/authMethod}}
{{/interface}}

! End of configuration
